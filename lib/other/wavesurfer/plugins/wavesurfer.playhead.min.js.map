{"version":3,"file":"wavesurfer.playhead.min.js","mappings":";;;;;CAAA,SAA2CA,EAAMC,GAC1B,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,IACQ,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,aAAc,GAAIH,GACC,iBAAZC,QACdA,QAAoB,WAAID,KAExBD,EAAiB,WAAIA,EAAiB,YAAK,GAAIA,EAAiB,WAAY,SAAIC,KARlF,CASGK,MAAM,WACT,Y,wQCkBA,IAEqBC,EAAAA,WA2BjB,WAAYC,EAAQC,GAAI,Y,4FAAA,SACpBC,KAAKF,OAASA,EACdE,KAAKC,QAAU,GAEf,CAAC,OAAQ,aAAc,iBAAiBC,SAAQ,SAAAC,GAExC,EAAKF,QAAQE,KADbA,KAAOL,IACaA,EAAOK,MAOnCH,KAAKI,WAAaL,EAClBC,KAAKK,KAAON,EAAGM,KACfL,KAAKM,MAAQN,KAAKK,KAAKC,MACvBN,KAAKO,YAAc,GACnBP,KAAKQ,aAAe,GACpBR,KAAKS,aAAe,EACpBT,KAAKU,OAAS,GAEdV,KAAKW,UAAY,WACb,EAAKC,2BAGTZ,KAAKa,SAAW,WACZ,EAAKC,QAAU,EAAKV,WAAWW,OAAOD,QACtC,EAAKF,2B,4CApCb,SAAcd,GACV,MAAO,CACHkB,KAAM,WACNC,aAAWnB,IAAUA,EAAOmB,YAAYnB,EAAOmB,UAC/CnB,OAAQA,EACRoB,SAAUrB,O,kCAmClB,WAAoB,WAChBG,KAAKc,QAAUd,KAAKI,WAAWW,OAAOD,QAElCd,KAAKC,QAAQkB,OACbnB,KAAKoB,yBACLC,OAAOC,iBAAiB,SAAUtB,KAAKW,WAAW,GAClDU,OAAOC,iBAAiB,oBAAqBtB,KAAKW,WAAW,GAE7DX,KAAKuB,aAAa,OAAQvB,KAAKW,YAGnCX,KAAKuB,aAAa,SAAS,WAClB,EAAKtB,QAAQuB,eACd,EAAKpB,WAAWqB,eAAe,EAAKhB,iBAI5CT,KAAKuB,aAAa,QAAQ,WACjB,EAAKtB,QAAQyB,aACd,EAAKjB,aAAe,EAAKL,WAAWuB,iBACpC,EAAKf,8BAIbZ,KAAKS,aAAeT,KAAKI,WAAWuB,mB,0BAGxC,SAAaC,EAAIC,GAAI,WACbC,EAAM9B,KAAKI,WAAW2B,GAAGH,EAAIC,GAIjC,OAHA7B,KAAKU,OAAOsB,MAAK,WACb,EAAK5B,WAAW6B,GAAGL,EAAIC,MAEpBC,I,kBAGX,WAAO,WACC9B,KAAKI,WAAW8B,SAChBlC,KAAKmC,oBACLnC,KAAKa,aAILb,KAAKI,WAAWgC,KAAK,SAAS,kBAAM,EAAKvB,cACzCb,KAAKI,WAAWgC,KAAK,mBAAmB,kBAAM,EAAKD,0B,qBAI3D,WACInC,KAAKU,OAAOR,SAAQ,SAAAmC,GAAC,OAAIA,OACzBrC,KAAKU,OAAS,GAEdV,KAAKc,QAAQwB,YAAYtC,KAAKuC,SAE9BlB,OAAOmB,oBAAoB,SAAUxC,KAAKW,WAAW,GACrDU,OAAOmB,oBAAoB,oBAAqBxC,KAAKW,WAAW,K,6BAGpE,SAAgB8B,GACZzC,KAAKS,aAAegC,EAEfzC,KAAKI,WAAWsC,aACjB1C,KAAKI,WAAWqB,eAAegB,GAEnCzC,KAAKY,4B,+BAGT,WACI,IAAM+B,EAAQ,6BAERC,EAAKC,SAASC,gBAAgBH,EAAO,OACrCI,EAAOF,SAASC,gBAAgBH,EAAO,QAe7C,OAbAC,EAAGI,aAAa,UAAW,aAC3BD,EAAKC,aAAa,IAAK,kFACvBD,EAAKC,aAAa,SAAU,WAC5BD,EAAKC,aAAa,OAvIC,WAyInBJ,EAAGK,YAAYF,GAEf/C,KAAKM,MAAMsC,EAAI,CACXM,MAAOlD,KAAKO,YAAc,KAC1B4C,OAAQnD,KAAKQ,aAAe,KAC5B4C,OAAQ,UACR,UAAW,IAERR,I,oCAGX,WAAyB,WACfA,EAAKC,SAASQ,cAAc,YAClCT,EAAGU,UAAY,sBAEftD,KAAKM,MAAMsC,EAAI,CACXW,SAAU,WACVJ,OAAQ,OACRK,QAAS,OACT,iBAAkB,WAGtB,IAAMC,EAAUzD,KAAK0D,oBACrBd,EAAGK,YAAYQ,GAEfA,EAAQnC,iBAAiB,SAAS,SAAAqC,GAC9BA,EAAEC,kBACF,EAAKxD,WAAWqB,eAAe,EAAKhB,iBAGxC,IAAMoD,EAAOhB,SAASQ,cAAc,OACpCrD,KAAKM,MAAMuD,EAAM,CACb,YAAa,EACb,cAAgB7D,KAAKO,YAAc,EAAI,GAAO,KAC9CuD,WAAY,QACZZ,MAAO,MACPa,QAAS,KAGbnB,EAAGK,YAAYY,GAEf7D,KAAKuC,QAAUK,EACf5C,KAAKc,QAAQmC,YAAYL,K,qCAG7B,WACI,GAAK5C,KAAKuC,QAAV,CAIA,IAAMyB,EAAWhE,KAAKI,WAAW6D,cAC3BC,EACFlE,KAAKI,WAAWW,OAAOmC,MACvBlD,KAAKI,WAAWN,OAAOqE,WAErBC,EAAcpE,KAAKS,aAAeuD,EACxChE,KAAKM,MAAMN,KAAKuC,QAAS,CACrB8B,KAAQH,EAAeE,EAAgBpE,KAAKO,YAAc,EAAM,a,6BAhMvDV,G,kCC7BjByE,EAA2B,GCE/B,IAAIC,EDCJ,SAASC,EAAoBC,GAE5B,IAAIC,EAAeJ,EAAyBG,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAalF,QAGrB,IAAIC,EAAS6E,EAAyBG,GAAY,CAGjDjF,QAAS,IAOV,OAHAoF,EAAoBH,GAAUhF,EAAQA,EAAOD,QAASgF,GAG/C/E,EAAOD,QClBWgF,CAAoB,K,UHO9C","sources":["webpack://WaveSurfer.[name]/webpack/universalModuleDefinition","webpack://WaveSurfer.[name]/./src/plugin/playhead/index.js","webpack://WaveSurfer.[name]/webpack/bootstrap","webpack://WaveSurfer.[name]/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"WaveSurfer\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"WaveSurfer\"] = factory();\n\telse\n\t\troot[\"WaveSurfer\"] = root[\"WaveSurfer\"] || {}, root[\"WaveSurfer\"][\"playhead\"] = factory();\n})(self, function() {\nreturn ","\r\n/**\r\n * The playhead plugin separates the notion of the currently playing position from\r\n * a 'play-start' position.  Having a playhead enables a listening pattern\r\n * (commonly found in DAWs) that involves listening to a section of a track\r\n * repeatedly, rather than listening to an entire track in a linear fashion.\r\n *\r\n * @implements {PluginClass}\r\n *\r\n * @example\r\n * import PlayheadPlugin from 'wavesurfer.playhead.js';\r\n *\r\n * // if you are using <script> tags\r\n * var PlayheadPlugin = window.WaveSurfer.playhead;\r\n *\r\n * // ... initialising wavesurfer with the plugin\r\n * var wavesurfer = WaveSurfer.create({\r\n *   // wavesurfer options ...\r\n *   plugins: [\r\n *     PlayheadPlugin.create({\r\n *        movePlayheadOnSeek: true,\r\n *        drawPlayhead: false,\r\n *        movePlayheadOnPause: false\r\n *     })\r\n *   ]\r\n * });\r\n */\r\n\r\nconst DEFAULT_FILL_COLOR = '#CF2F00';\r\n\r\nexport default class PlayheadPlugin {\r\n    /**\r\n     * @typedef {Object} PlayheadPluginParams\r\n     * @property {?boolean} draw=true Draw the playhead as a triangle/line\r\n     * @property {?boolean} moveOnSeek=true Seeking (via clicking) while playing moves the playhead\r\n     * @property {?boolean} returnOnPause=true Pausing the track returns the seek position to the playhead\r\n     */\r\n\r\n    /**\r\n     * Playhead plugin definition factory\r\n     *\r\n     * This function must be used to create a plugin definition which can be\r\n     * used by wavesurfer to correctly instantiate the plugin.\r\n     *\r\n     * @param {PlayheadPluginParams} params parameters use to initialise the plugin\r\n     * @since 5.0.0\r\n     * @return {PluginDefinition} an object representing the plugin\r\n     */\r\n    static create(params) {\r\n        return {\r\n            name: 'playhead',\r\n            deferInit: params && params.deferInit ? params.deferInit : false,\r\n            params: params,\r\n            instance: PlayheadPlugin\r\n        };\r\n    }\r\n\r\n    constructor(params, ws) {\r\n        this.params = params;\r\n        this.options = {};\r\n\r\n        ['draw', 'moveOnSeek', 'returnOnPause'].forEach(opt => {\r\n            if (opt in params) {\r\n                this.options[opt] = params[opt];\r\n            } else {\r\n                this.options[opt] = true;\r\n            }\r\n        });\r\n\r\n\r\n        this.wavesurfer = ws;\r\n        this.util = ws.util;\r\n        this.style = this.util.style;\r\n        this.markerWidth = 21;\r\n        this.markerHeight = 16;\r\n        this.playheadTime = 0;\r\n        this.unFuns = [];\r\n\r\n        this._onResize = () => {\r\n            this._updatePlayheadPosition();\r\n        };\r\n\r\n        this._onReady = () => {\r\n            this.wrapper = this.wavesurfer.drawer.wrapper;\r\n            this._updatePlayheadPosition();\r\n        };\r\n    }\r\n\r\n    _onBackendCreated() {\r\n        this.wrapper = this.wavesurfer.drawer.wrapper;\r\n\r\n        if (this.options.draw) {\r\n            this._createPlayheadElement();\r\n            window.addEventListener('resize', this._onResize, true);\r\n            window.addEventListener('orientationchange', this._onResize, true);\r\n\r\n            this.wavesurferOn('zoom', this._onResize);\r\n        }\r\n\r\n        this.wavesurferOn('pause', () => {\r\n            if ( this.options.returnOnPause ) {\r\n                this.wavesurfer.setCurrentTime(this.playheadTime);\r\n            }\r\n        });\r\n\r\n        this.wavesurferOn('seek', () => {\r\n            if ( this.options.moveOnSeek ) {\r\n                this.playheadTime = this.wavesurfer.getCurrentTime();\r\n                this._updatePlayheadPosition();\r\n            }\r\n        });\r\n\r\n        this.playheadTime = this.wavesurfer.getCurrentTime();\r\n    }\r\n\r\n    wavesurferOn(ev, fn) {\r\n        let ret = this.wavesurfer.on(ev, fn);\r\n        this.unFuns.push(() => {\r\n            this.wavesurfer.un(ev, fn);\r\n        });\r\n        return ret;\r\n    }\r\n\r\n    init() {\r\n        if (this.wavesurfer.isReady) {\r\n            this._onBackendCreated();\r\n            this._onReady();\r\n        } else {\r\n            let r;\r\n\r\n            this.wavesurfer.once('ready', () => this._onReady());\r\n            this.wavesurfer.once('backend-created', () => this._onBackendCreated());\r\n        }\r\n    }\r\n\r\n    destroy() {\r\n        this.unFuns.forEach(f => f());\r\n        this.unFuns = [];\r\n\r\n        this.wrapper.removeChild(this.element);\r\n\r\n        window.removeEventListener('resize', this._onResize, true);\r\n        window.removeEventListener('orientationchange', this._onResize, true);\r\n    }\r\n\r\n    setPlayheadTime(time) {\r\n        this.playheadTime = time;\r\n\r\n        if (!this.wavesurfer.isPlaying()) {\r\n            this.wavesurfer.setCurrentTime(time);\r\n        }\r\n        this._updatePlayheadPosition();\r\n    }\r\n\r\n    _createPointerSVG() {\r\n        const svgNS = 'http://www.w3.org/2000/svg';\r\n\r\n        const el = document.createElementNS(svgNS, 'svg');\r\n        const path = document.createElementNS(svgNS, 'path');\r\n\r\n        el.setAttribute('viewBox', '0 0 33 30');\r\n        path.setAttribute('d', 'M16.75 31 31.705 5.566A3 3 0 0 0 29.146 1H4.354a3 3 0 0 0-2.56 4.566L16.75 31z');\r\n        path.setAttribute('stroke', '#979797');\r\n        path.setAttribute('fill', DEFAULT_FILL_COLOR);\r\n\r\n        el.appendChild(path);\r\n\r\n        this.style(el, {\r\n            width: this.markerWidth + 'px',\r\n            height: this.markerHeight + 'px',\r\n            cursor: 'pointer',\r\n            'z-index': 5\r\n        });\r\n        return el;\r\n    }\r\n\r\n    _createPlayheadElement() {\r\n        const el = document.createElement('playhead');\r\n        el.className = 'wavesurfer-playhead';\r\n\r\n        this.style(el, {\r\n            position: 'absolute',\r\n            height: '100%',\r\n            display: 'flex',\r\n            'flex-direction': 'column'\r\n        });\r\n\r\n        const pointer = this._createPointerSVG();\r\n        el.appendChild(pointer);\r\n\r\n        pointer.addEventListener('click', e => {\r\n            e.stopPropagation();\r\n            this.wavesurfer.setCurrentTime(this.playheadTime);\r\n        });\r\n\r\n        const line = document.createElement('div');\r\n        this.style(line, {\r\n            'flex-grow': 1,\r\n            'margin-left': (this.markerWidth / 2 - 0.5) + 'px',\r\n            background: 'black',\r\n            width: '1px',\r\n            opacity: 0.1\r\n        });\r\n\r\n        el.appendChild(line);\r\n\r\n        this.element = el;\r\n        this.wrapper.appendChild(el);\r\n    }\r\n\r\n    _updatePlayheadPosition() {\r\n        if (!this.element) {\r\n            return;\r\n        }\r\n\r\n        const duration = this.wavesurfer.getDuration();\r\n        const elementWidth =\r\n            this.wavesurfer.drawer.width /\r\n            this.wavesurfer.params.pixelRatio;\r\n\r\n        const positionPct = this.playheadTime / duration;\r\n        this.style(this.element, {\r\n            left: ((elementWidth * positionPct) - (this.markerWidth / 2)) + 'px'\r\n        });\r\n    }\r\n}\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(374);\n"],"names":["root","factory","exports","module","define","amd","self","PlayheadPlugin","params","ws","this","options","forEach","opt","wavesurfer","util","style","markerWidth","markerHeight","playheadTime","unFuns","_onResize","_updatePlayheadPosition","_onReady","wrapper","drawer","name","deferInit","instance","draw","_createPlayheadElement","window","addEventListener","wavesurferOn","returnOnPause","setCurrentTime","moveOnSeek","getCurrentTime","ev","fn","ret","on","push","un","isReady","_onBackendCreated","once","f","removeChild","element","removeEventListener","time","isPlaying","svgNS","el","document","createElementNS","path","setAttribute","appendChild","width","height","cursor","createElement","className","position","display","pointer","_createPointerSVG","e","stopPropagation","line","background","opacity","duration","getDuration","elementWidth","pixelRatio","positionPct","left","__webpack_module_cache__","__webpack_exports__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__"],"sourceRoot":""}